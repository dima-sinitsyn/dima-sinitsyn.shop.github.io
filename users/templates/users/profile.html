{% extends "base.html" %}
{% load static %}
{% load carts_tags %} 






{% block content %}
<div class="row">
    <div class="container mt-5">
        <div class="row">
            <!-- –ü—Ä–æ—Ñ–∏–ª—å —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
            <div class="col-md-5">
                <div class=" bg-white p-4 mb-4 mx-2 rounded custom-shadow">
                    <h3 class="text-center mb-4">–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è </h3>
                    <form action="{% url "user:profile" %}" method = "post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-md-12 mb-3 text-center">
                                {% if user.image %}
                                    <img src="{{ user.image.url }}"
                                        alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" class="img-fluid rounded-circle"
                                        style="max-width: 150px;">
                                {% else %}
                                    <img src="{% static "deps/images/baseavatar.jpg" %}"
                                        alt="–ê–≤–∞—Ç–∞—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" class="img-fluid rounded-circle"
                                        style="max-width: 200px;">
                                {% endif %}
                                
                                <input type="file" class="form-control mt-3" id="id_image"
                                    name="image"
                                    accept="image/*">
                                    {% if form.image.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.image.errors}}</div>
                                    {% endif %}
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="id_first_name" class="form-label">–ò–º—è*</label>
                                <input type="text" class="form-control" id="id_first_name"
                                    name="first_name"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" value="{{form.first_name.value}}" required>
                                    {% if form.first_name.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.first_name.errors}}</div>
                                    {% endif %}
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="id_last_name" class="form-label">–§–∞–º–∏–ª–∏—è*</label>
                                <input type="text" class="form-control" id="id_last_name"
                                    name="last_name"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —Ñ–∞–º–∏–ª–∏—é" value="{{form.last_name.value}}" required>
                                    {% if form.last_name.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.last_name.errors}}</div>
                                    {% endif %}
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="id_username" class="form-label">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è*</label>
                                <input type="text" class="form-control" id="id_username"
                                    name="username"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" value="{{form.username.value}}" required>
                                    {% if form.username.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.username.errors}}</div>
                                    {% endif %}
                            </div>
                          
                            <div class="col-md-12 mb-3">
                                <label for="id_gender_yours" class="form-label">–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –ø–æ–ª</label>
                                <input type="text" class="form-control" id="id_gender_yours"
                                    name="gender_yours"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø–æ–ª" value="{{form.gender_yours.value}}" >
                                    {% comment %} {% if form.gender_yours.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.gender_yours.errors}}</div>
                                    {% endif %} {% endcomment %}
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="id_telephone" class="form-label">–†–∞–±–æ—á–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</label>
                                <input type="text" class="form-control" id="id_telephone"
                                    name="telephone"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à —Ä–∞–±–æ—á–∏–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞" value="{{form.telephone.value}}" >
                                    {% comment %} {% if form.telephone.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.telephone.errors}}</div>
                                    {% endif %} {% endcomment %}
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="id_adress_living_city" class="form-label">–ì–æ—Ä–æ–¥ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</label>
                                <input type="text" class="form-control" id="id_adress_living_city"
                                    name="adress_living_city"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥, –≥–¥–µ –≤—ã –ø—Ä–æ–∂–∏–≤–∞–µ—Ç–µ" value="{{form.adress_living_city.value}}" >
                                    {% comment %} {% if form.adress_living_city.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.adress_living_city.errors}}</div>
                                    {% endif %} {% endcomment %}
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="id_adress_living2" class="form-label">–£–ª–∏—Ü–∞ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</label>
                                <input type="text" class="form-control" id="id_adress_living2"
                                    name="adress_living2"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —É–ª–∏—Ü—É" value="{{form.adress_living2.value}}" >
                                    {% comment %} {% if form.adress_living2.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.adress_living2.errors}}</div>
                                    {% endif %} {% endcomment %}
                            </div>
                            <div class="col-md-12 mb-3">
                                <label for="id_adress_living3" class="form-label">–î–æ–º –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</label>
                                <input type="text" class="form-control" id="id_adress_living3"
                                    name="adress_living3"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –¥–æ–º" value="{{form.adress_living3.value}}" >
                                    {% comment %} {% if form.adress_living3.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.adress_living3.errors}}</div>
                                    {% endif %} {% endcomment %}
                            </div>  
                            <div class="col-md-12 mb-3">
                                <label for="id_flat" class="form-label">–ö–≤–∞—Ä—Ç–∏—Ä—É –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è</label>
                                <input type="text" class="form-control" id="id_flat"
                                    name="flat"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É –∫–≤–∞—Ä—Ç–∏—Ä—É" value="{{form.flat.value}}" >
                                    {% comment %} {% if form.flat.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.flat.errors}}</div>
                                    {% endif %} {% endcomment %}
                            </div>  

                            <div class="col-md-12 mb-3">
                                <label for="id_email" class="form-label">Email*</label>
                                <input type="email" class="form-control" id="id_email"
                                    name="email"
                                    placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email *youremail@example.com" value="{{form.email.value}}"
                                    required>
                                    {% if form.email.errors %}
                                        <div class="alert alert-danger alert-dismissible fade show">{{form.email.errors}}</div>
                                    {% endif %}
                            </div>
                        </div>
                        <button type="submit" class="btn btn-dark">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    </form>
                </div>
            </div>
            <!-- –ö–æ—Ä–∑–∏–Ω–∞ --> 
            {% user_carts request as carts %} 
            
            <div class="col-md-7">
                <div class=" bg-white p-4 mb-4 mx-2 rounded custom-shadow">
                    <h3 class="text-center mb-4">–ö–æ—Ä–∑–∏–Ω–∞</h3>
                    <div class="container" id="cart-items-container">
                        <!-- –†–∞–∑–º–µ—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
                        {% include "carts/includes/included_cart.html" %}  
                        <!-- –ó–∞–∫–æ–Ω—á–∏–ª–∞—Å—å —Ä–∞–∑–º–µ—Ç–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã -->
                        
                    </div>
                    {% comment %} {% if carts %}
                        <a class="btn btn-dark" href="orders/create_order.html">
                            –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑
                        </a>
                    {% endif %} {% endcomment %}
                </div>
            </div>
            <!-- –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—ã–µ –∑–∞–∫–∞–∑—ã -->
            <div class="col-md-12">
                <div class=" bg-white p-4 mb-4 mx-2 rounded custom-shadow">
                    <h3 class="text-center mb-4">–ú–æ–∏ –∑–∞–∫–∞–∑—ãüòÉ</h3>
                    <!-- –†–∞–∑–º–µ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤ -->
                    <div class="container">
                        <div class="accordion" id="accordionExample">
                            {% for order in orders %}
                            <div class="accordion-item">
                                <h2 class="accordion-header" id="heading{{ order.id }}">
                                    <button class="accordion-button {% if order != orders.0 %}collapsed{% endif %}" type="button" data-bs-toggle="collapse" data-bs-target="#collapse{{ order.id }}" aria-expanded="false" aria-controls="collapse{{ order.id }}">
                                        –ó–∞–∫–∞–∑ ‚Ññ {{ order.id }} - {{ order.created_timestamp }} | –°—Ç–∞—Ç—É—Å: <strong class="mx-2">{{order.status}}</strong>
                                    </button>
                                </h2>
                                <div id="collapse{{ order.id }}" class="accordion-collapse collapse {% if order == orders.0 %}show{% endif %}" aria-labelledby="heading{{ order.id }}" data-bs-parent="#accordionExample">
                                    <div class="accordion-body">
                                        <table class="table table-dark table-hover">
                                            <thead>
                                                <tr>
                                                    <th>–¢–æ–≤–∞—Ä</th>
                                                    <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
                                                    <th>–¶–µ–Ω–∞</th>
                                                    <th>–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for item in order.orderitem_set.all %}
                                                <tr>
                                                    <td><a class="text-white" href="{% url 'goods1:product' item.product.slug %}">{{ item.product.name }}</a></td>
                                                    <td>{{ item.quantity }}</td>
                                                    <td>{{ item.price }}</td>
                                                    <td>{{ item.products_price }}</td>
                                                    
                                                </tr>
                                                {% endfor %}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    <!-- –ó–∞–∫–æ–Ω—á–∏–ª–∞—Å—å —Ä–∞–∑–º–µ—Ç–∫–∞ –∑–∞–∫–∞–∑–æ–≤ -->
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock  %}

